<!doctype html>
<html>
<head>
    <title>Database List</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <link  href="https://cdn.datatables.net/2.2.1/css/dataTables.dataTables.min.css" rel="stylesheet">
    <script src="https://cdn.datatables.net/2.2.1/js/dataTables.min.js"></script>
</head>
<body>
<div id="content">
<div class="text-center" style="display:flex;justify-content: center">
    <table class="table table-hover table-bordered align-middle table-responsive-sm display" id="buildTable" style="width: fit-content;padding: 20px">
        <thead class="table-dark">
        <tr>
            <th scope="col">DB name</th>
            <th scope="col">Host</th>
            <th scope="col">Image<br/>version</th>
            <th scope="col" style="width: 70px;">config<br/>file</th>
            <th scope="col" style="width: 70px;">config<br/>loaded</th>
            <th scope="col" style="width: 70px">nfsdb<br/>file</th>
            <th scope="col" style="width: 70px">nfsdb<br/>loaded</th>
            <th scope="col" style="width: 70px;">deps<br/>loaded</th>
        </tr>
        </thead>
        <tbody>
        {% for host, val in backend.items() %}
          {% if val is not none %}
            {% for endpoint, v in val.items() %}
            {% if engine != v['image_version'] %}
            <tr class="table-danger" title="Image version not compatibile with engine version!">
            {%else%}
            <tr>
            {%endif%}
                <td class="text-start fw-bolder"><a href='{{ web_ctx }}{{ endpoint }}'>{{ endpoint }}</a></td>
                <td class="text-center">{{ v['host'] }}</td>
                <td class="text-center">{{ v['image_version'] }}</td>
                <td class="text-center"><i class="bi {{ "bi-check-circle-fill" if v['config_path']  else "bi-circle" }}"></i></td>
                <td class="text-center"><i class="bi {{ "bi-check-circle-fill" if v['loaded_config'] else "bi-circle" }}"></i></td>
                <td class="text-center"><i class="bi {{ "bi-check-circle-fill" if v['nfsdb_path'] else "bi-circle" }}"></i></td>
                <td class="text-center"><i class="bi {{ "bi-check-circle-fill" if v['loaded_nfsdb'] else "bi-circle" }}"></i></td>
                <td class="text-center"><i class="bi {{ "bi-check-circle-fill" if v['deps_path'] else "bi-circle" }}"></i></td>
            </tr>
            {% endfor %}
          {% endif %}
        {% endfor %}
        </tbody>
    </table>

</div>
{% for err in not_responding %}
<div class="alert alert-warning" role="alert">
    <strong>{{err}}</strong>
</div>
{% endfor %}
</div>
<div id="footer">

</div>
</body>
<script>$(document).ready( function () {
    new DataTable('#buildTable', {
    lengthMenu: [
        [50, 100, 500, -1],
        [50, 100, 500, 'All']
    ]
});
} );
</script>
</html>